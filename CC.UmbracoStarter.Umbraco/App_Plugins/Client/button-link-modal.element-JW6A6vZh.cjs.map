{"version":3,"file":"button-link-modal.element-JW6A6vZh.cjs","sources":["../../Client/src/button-link/button-link-modal/button-link-modal.element.ts"],"sourcesContent":["import type { ButtonLinkPickerLink } from \"./types.js\";\r\nimport type {\r\n  UmbLinkPickerConfig,\r\n  ButtonLinkPickerModalData,\r\n  ButtonLinkPickerModalValue,\r\n} from \"./button-link-modal.token.js\";\r\nimport {\r\n  css,\r\n  customElement,\r\n  html,\r\n  nothing,\r\n  query,\r\n  state,\r\n  when,\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport {\r\n  isUmbracoFolder,\r\n  UmbMediaTypeStructureRepository,\r\n} from \"@umbraco-cms/backoffice/media-type\";\r\nimport {\r\n  umbBindToValidation,\r\n  UmbValidationContext,\r\n} from \"@umbraco-cms/backoffice/validation\";\r\nimport {\r\n  umbConfirmModal,\r\n  UmbModalBaseElement,\r\n} from \"@umbraco-cms/backoffice/modal\";\r\nimport { UmbDocumentDetailRepository } from \"@umbraco-cms/backoffice/document\";\r\nimport { UmbMediaDetailRepository } from \"@umbraco-cms/backoffice/media\";\r\nimport type { UmbInputDocumentElement } from \"@umbraco-cms/backoffice/document\";\r\nimport type { UmbInputMediaElement } from \"@umbraco-cms/backoffice/media\";\r\nimport type {\r\n  UUIBooleanInputEvent,\r\n  UUIColorPickerChangeEvent,\r\n  UUIInputElement,\r\n  UUIInputEvent,\r\n} from \"@umbraco-cms/backoffice/external/uui\";\r\n\r\ntype UmbInputPickerEvent = CustomEvent & { target: { value?: string } };\r\n\r\n@customElement(\"button-link-picker-modal\")\r\nexport class UmbLinkPickerModalElement extends UmbModalBaseElement<\r\n  ButtonLinkPickerModalData,\r\n  ButtonLinkPickerModalValue\r\n> {\r\n  #propertyLayoutOrientation: \"horizontal\" | \"vertical\" = \"vertical\";\r\n\r\n  #validationContext = new UmbValidationContext(this);\r\n\r\n  @state()\r\n  private _allowedMediaTypeUniques?: Array<string>;\r\n\r\n  @state()\r\n  private _config: UmbLinkPickerConfig = {\r\n    hideAnchor: false,\r\n    hideTarget: false,\r\n  };\r\n\r\n  @query(\"umb-input-document\")\r\n  private _documentPickerElement?: UmbInputDocumentElement;\r\n\r\n  @query(\"umb-input-media\")\r\n  private _mediaPickerElement?: UmbInputMediaElement;\r\n\r\n  @query(\"#link-anchor\", true)\r\n  private _linkAnchorInput?: UUIInputElement;\r\n\r\n  override connectedCallback() {\r\n    super.connectedCallback();\r\n\r\n    if (this.data?.config) {\r\n      this._config = this.data.config;\r\n    }\r\n\r\n    if (this.modalContext) {\r\n      this.observe(this.modalContext.size, (size) => {\r\n        if (size === \"large\" || size === \"full\") {\r\n          this.#propertyLayoutOrientation = \"horizontal\";\r\n        }\r\n      });\r\n    }\r\n\r\n    this.#getMediaTypes();\r\n  }\r\n\r\n  protected override firstUpdated() {\r\n    this._linkAnchorInput?.addValidator(\r\n      \"valueMissing\",\r\n      () => this.localize.term(\"linkPicker_modalAnchorValidationMessage\"),\r\n      () => !this.value.link.url && !this.value.link.queryString\r\n    );\r\n  }\r\n\r\n  async #getMediaTypes() {\r\n    // Get all the media types, excluding the folders, so that files are selectable media items.\r\n    const mediaTypeStructureRepository = new UmbMediaTypeStructureRepository(\r\n      this\r\n    );\r\n    const { data: mediaTypes } =\r\n      await mediaTypeStructureRepository.requestAllowedChildrenOf(null);\r\n    this._allowedMediaTypeUniques =\r\n      (mediaTypes?.items\r\n        .map((x) => x.unique)\r\n        .filter((x) => x && !isUmbracoFolder(x)) as Array<string>) ?? [];\r\n  }\r\n\r\n  #partialUpdateLink(linkObject: Partial<ButtonLinkPickerLink>) {\r\n    this.modalContext?.updateValue({\r\n      link: { ...this.value.link, ...linkObject },\r\n    });\r\n  }\r\n\r\n  #onLinkAnchorInput(event: UUIInputEvent) {\r\n    const query = (event.target.value as string) ?? \"\";\r\n    if (query.startsWith(\"#\") || query.startsWith(\"?\")) {\r\n      this.#partialUpdateLink({ queryString: query });\r\n      return;\r\n    }\r\n\r\n    if (query.includes(\"=\")) {\r\n      this.#partialUpdateLink({ queryString: `?${query}` });\r\n    } else if (query) {\r\n      this.#partialUpdateLink({ queryString: `#${query}` });\r\n    } else {\r\n      this.#partialUpdateLink({ queryString: \"\" });\r\n    }\r\n  }\r\n\r\n  #onLinkTitleInput(event: UUIInputEvent) {\r\n    this.#partialUpdateLink({ name: event.target.value as string });\r\n  }\r\n\r\n  #onLinkTargetInput(event: UUIBooleanInputEvent) {\r\n    this.#partialUpdateLink({\r\n      target: event.target.checked ? \"_blank\" : undefined,\r\n    });\r\n  }\r\n\r\n  #onLinkUrlInput(event: UUIInputEvent) {\r\n    const url = event.target.value as string;\r\n\r\n    let name;\r\n    if (url && !this.value.link.name) {\r\n      if (URL.canParse(url)) {\r\n        // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n        // @ts-ignore\r\n        const parts = URL.parse(url);\r\n        name = parts?.hostname ?? url;\r\n      } else {\r\n        name = url;\r\n      }\r\n    }\r\n\r\n    this.#partialUpdateLink({\r\n      name: this.value.link.name || name,\r\n      type: \"external\",\r\n      url,\r\n    });\r\n  }\r\n\r\n  async #onPickerSelection(\r\n    event: UmbInputPickerEvent,\r\n    type: \"document\" | \"media\"\r\n  ) {\r\n    let icon, name, url;\r\n    const unique = event.target.value;\r\n\r\n    if (unique) {\r\n      switch (type) {\r\n        case \"document\": {\r\n          const documentRepository = new UmbDocumentDetailRepository(this);\r\n          const { data: documentData } =\r\n            await documentRepository.requestByUnique(unique);\r\n          if (documentData) {\r\n            icon = documentData.documentType.icon;\r\n            name = documentData.variants[0].name;\r\n            url = documentData.urls[0]?.url ?? \"\";\r\n          }\r\n          break;\r\n        }\r\n        case \"media\": {\r\n          const mediaRepository = new UmbMediaDetailRepository(this);\r\n          const { data: mediaData } = await mediaRepository.requestByUnique(\r\n            unique\r\n          );\r\n          if (mediaData) {\r\n            icon = mediaData.mediaType.icon;\r\n            name = mediaData.variants[0].name;\r\n            url = mediaData.urls[0].url;\r\n          }\r\n          break;\r\n        }\r\n        default:\r\n          break;\r\n      }\r\n    }\r\n\r\n    const link = {\r\n      icon,\r\n      name: this.value.link.name || name,\r\n      type: unique ? type : undefined,\r\n      unique,\r\n      url: url ?? this.value.link.url,\r\n    };\r\n\r\n    this.#partialUpdateLink(link);\r\n\r\n    await this.#validationContext.validate();\r\n  }\r\n\r\n  async #onResetUrl() {\r\n    if (this.value.link.url) {\r\n      await umbConfirmModal(this, {\r\n        color: \"danger\",\r\n        headline: this.localize.term(\"linkPicker_resetUrlHeadline\"),\r\n        content: this.localize.term(\"linkPicker_resetUrlMessage\"),\r\n        confirmLabel: this.localize.term(\"linkPicker_resetUrlLabel\"),\r\n      });\r\n    }\r\n\r\n    this.#partialUpdateLink({ type: null, url: null });\r\n  }\r\n\r\n  async #onSubmit() {\r\n    await this.#validationContext.validate();\r\n    this.modalContext?.submit();\r\n  }\r\n\r\n  #triggerDocumentPicker() {\r\n    this._documentPickerElement?.shadowRoot\r\n      ?.querySelector(\"#btn-add\")\r\n      ?.dispatchEvent(new Event(\"click\"));\r\n  }\r\n\r\n  #triggerMediaPicker() {\r\n    this._mediaPickerElement?.shadowRoot\r\n      ?.querySelector(\"#btn-add\")\r\n      ?.dispatchEvent(new Event(\"click\"));\r\n  }\r\n\r\n  #triggerExternalUrl() {\r\n    this.#partialUpdateLink({ type: \"external\" });\r\n  }\r\n\r\n  override render() {\r\n    return html`\r\n      <umb-body-layout\r\n        headline=${this.localize.term(\r\n          this.modalContext?.data.isNew\r\n            ? \"defaultdialogs_addLink\"\r\n            : \"defaultdialogs_updateLink\"\r\n        )}\r\n      >\r\n        <uui-box>\r\n          ${this.#renderLinkType()} ${this.#renderLinkAnchorInput()}\r\n          ${this.#renderLinkTitleInput()} ${this.#renderLinkTargetInput()}\r\n          ${this.#renderBackgroundColorInput()}\r\n        </uui-box>\r\n        <div slot=\"actions\">\r\n          <uui-button\r\n            label=${this.localize.term(\"general_close\")}\r\n            @click=${this._rejectModal}\r\n          ></uui-button>\r\n          <uui-button\r\n            color=\"positive\"\r\n            look=\"primary\"\r\n            label=${this.localize.term(\r\n              this.modalContext?.data.isNew ? \"general_add\" : \"general_update\"\r\n            )}\r\n            ?disabled=${!this.value.link.type}\r\n            @click=${this.#onSubmit}\r\n          ></uui-button>\r\n        </div>\r\n      </umb-body-layout>\r\n    `;\r\n  }\r\n\r\n  #onChange(e: UUIColorPickerChangeEvent) {\r\n    e.stopPropagation();\r\n    this.modalContext?.updateValue({\r\n      link: { ...this.value.link, backgroundColor: e.target.value },\r\n    });\r\n  }\r\n\r\n  #renderBackgroundColorInput() {\r\n    return html`<uui-color-picker\r\n      label=\"Eye dropper\"\r\n      .value=${this.modalContext?.value.backgroundColor}\r\n      @change=${this.#onChange}\r\n    >\r\n    </uui-color-picker>`;\r\n  }\r\n\r\n  #renderLinkType() {\r\n    return html`\r\n      <umb-property-layout\r\n        orientation=${this.#propertyLayoutOrientation}\r\n        label=${this.localize.term(\"linkPicker_modalSource\")}\r\n        mandatory\r\n      >\r\n        <div slot=\"editor\">\r\n          ${this.#renderLinkTypeSelection()} ${this.#renderDocumentPicker()}\r\n          ${this.#renderMediaPicker()} ${this.#renderLinkUrlInput()}\r\n          ${this.#renderLinkUrlInputReadOnly()}\r\n        </div>\r\n      </umb-property-layout>\r\n    `;\r\n  }\r\n\r\n  #renderLinkTypeSelection() {\r\n    if (this.value.link.type) return nothing;\r\n    return html`\r\n      <uui-button-group>\r\n        <uui-button\r\n          data-mark=\"action:document\"\r\n          look=\"placeholder\"\r\n          label=${this.localize.term(\"general_content\")}\r\n          @click=${this.#triggerDocumentPicker}\r\n        ></uui-button>\r\n        <uui-button\r\n          data-mark=\"action:media\"\r\n          look=\"placeholder\"\r\n          label=${this.localize.term(\"general_media\")}\r\n          @click=${this.#triggerMediaPicker}\r\n        ></uui-button>\r\n        <uui-button\r\n          data-mark=\"action:external\"\r\n          look=\"placeholder\"\r\n          label=${this.localize.term(\"linkPicker_modalManual\")}\r\n          @click=${this.#triggerExternalUrl}\r\n        ></uui-button>\r\n      </uui-button-group>\r\n    `;\r\n  }\r\n\r\n  #renderDocumentPicker() {\r\n    return html`\r\n      <umb-input-document\r\n        ?hidden=${!this.value.link.unique ||\r\n        this.value.link.type !== \"document\"}\r\n        .max=${1}\r\n        .showOpenButton=${true}\r\n        .value=${this.value.link.unique && this.value.link.type === \"document\"\r\n          ? this.value.link.unique\r\n          : \"\"}\r\n        @change=${(e: UmbInputPickerEvent) =>\r\n          this.#onPickerSelection(e, \"document\")}\r\n      >\r\n      </umb-input-document>\r\n    `;\r\n  }\r\n\r\n  #renderMediaPicker() {\r\n    return html`\r\n      <umb-input-media\r\n        ?hidden=${!this.value.link.unique || this.value.link.type !== \"media\"}\r\n        .allowedContentTypeIds=${this._allowedMediaTypeUniques}\r\n        .max=${1}\r\n        .value=${this.value.link.unique && this.value.link.type === \"media\"\r\n          ? this.value.link.unique\r\n          : \"\"}\r\n        @change=${(e: UmbInputPickerEvent) =>\r\n          this.#onPickerSelection(e, \"media\")}\r\n      ></umb-input-media>\r\n    `;\r\n  }\r\n\r\n  #renderLinkUrlInput() {\r\n    if (this.value.link.type !== \"external\") return nothing;\r\n    return html`\r\n      <uui-input\r\n        data-mark=\"input:url\"\r\n        label=${this.localize.term(\"placeholders_enterUrl\")}\r\n        placeholder=${this.localize.term(\"placeholders_enterUrl\")}\r\n        .value=${this.value.link.url ?? \"\"}\r\n        ?disabled=${!!this.value.link.unique}\r\n        ?required=${this._config.hideAnchor}\r\n        @change=${this.#onLinkUrlInput}\r\n        ${umbBindToValidation(this)}\r\n      >\r\n        ${when(\r\n          !this.value.link.unique,\r\n          () => html`\r\n            <div slot=\"append\">\r\n              <uui-button\r\n                slot=\"append\"\r\n                compact\r\n                label=${this.localize.term(\"general_remove\")}\r\n                @click=${this.#onResetUrl}\r\n              >\r\n                <uui-icon name=\"remove\"></uui-icon>\r\n              </uui-button>\r\n            </div>\r\n          `\r\n        )}\r\n      </uui-input>\r\n    `;\r\n  }\r\n\r\n  #renderLinkUrlInputReadOnly() {\r\n    if (!this.value.link.unique || !this.value.link.url) return nothing;\r\n    return html`<uui-input readonly value=${this.value.link.url}></uui-input>`;\r\n  }\r\n\r\n  #renderLinkAnchorInput() {\r\n    if (this._config.hideAnchor) return nothing;\r\n    return html`\r\n      <umb-property-layout\r\n        orientation=${this.#propertyLayoutOrientation}\r\n        label=${this.localize.term(\"defaultdialogs_anchorLinkPicker\")}\r\n      >\r\n        <uui-input\r\n          data-mark=\"input:anchor\"\r\n          slot=\"editor\"\r\n          id=\"link-anchor\"\r\n          label=${this.localize.term(\"placeholders_anchor\")}\r\n          placeholder=${this.localize.term(\"placeholders_anchor\")}\r\n          .value=${this.value.link.queryString ?? \"\"}\r\n          @change=${this.#onLinkAnchorInput}\r\n          ${umbBindToValidation(this)}\r\n        ></uui-input>\r\n      </umb-property-layout>\r\n    `;\r\n  }\r\n\r\n  #renderLinkTitleInput() {\r\n    return html`\r\n      <umb-property-layout\r\n        orientation=${this.#propertyLayoutOrientation}\r\n        label=${this.localize.term(\"defaultdialogs_nodeNameLinkPicker\")}\r\n      >\r\n        <uui-input\r\n          data-mark=\"input:title\"\r\n          slot=\"editor\"\r\n          label=${this.localize.term(\"defaultdialogs_nodeNameLinkPicker\")}\r\n          placeholder=${this.localize.term(\"defaultdialogs_nodeNameLinkPicker\")}\r\n          .value=${this.value.link.name ?? \"\"}\r\n          @change=${this.#onLinkTitleInput}\r\n        >\r\n        </uui-input>\r\n      </umb-property-layout>\r\n    `;\r\n  }\r\n\r\n  #renderLinkTargetInput() {\r\n    if (this._config.hideTarget) return nothing;\r\n    return html`\r\n      <umb-property-layout\r\n        orientation=${this.#propertyLayoutOrientation}\r\n        label=${this.localize.term(\"content_target\")}\r\n      >\r\n        <uui-toggle\r\n          slot=\"editor\"\r\n          label=${this.localize.term(\"defaultdialogs_openInNewWindow\")}\r\n          .checked=${this.value.link.target === \"_blank\" ? true : false}\r\n          @change=${this.#onLinkTargetInput}\r\n        >\r\n          ${this.localize.term(\"defaultdialogs_openInNewWindow\")}\r\n        </uui-toggle>\r\n      </umb-property-layout>\r\n    `;\r\n  }\r\n\r\n  static override styles = [\r\n    css`\r\n      uui-box {\r\n        --uui-box-default-padding: 0 var(--uui-size-space-5);\r\n      }\r\n\r\n      uui-button-group {\r\n        width: 100%;\r\n      }\r\n\r\n      uui-input {\r\n        width: 100%;\r\n\r\n        &[readonly] {\r\n          margin-top: var(--uui-size-space-2);\r\n        }\r\n      }\r\n    `,\r\n  ];\r\n}\r\n\r\nexport default UmbLinkPickerModalElement;\r\n\r\nexport { UmbLinkPickerModalElement as element };\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    \"button-link-modal\": UmbLinkPickerModalElement;\r\n  }\r\n}\r\n"],"names":["_propertyLayoutOrientation","_validationContext","_UmbLinkPickerModalElement_instances","getMediaTypes_fn","partialUpdateLink_fn","onLinkAnchorInput_fn","onLinkTitleInput_fn","onLinkTargetInput_fn","onLinkUrlInput_fn","onPickerSelection_fn","onResetUrl_fn","onSubmit_fn","triggerDocumentPicker_fn","triggerMediaPicker_fn","triggerExternalUrl_fn","onChange_fn","renderBackgroundColorInput_fn","renderLinkType_fn","renderLinkTypeSelection_fn","renderDocumentPicker_fn","renderMediaPicker_fn","renderLinkUrlInput_fn","renderLinkUrlInputReadOnly_fn","renderLinkAnchorInput_fn","renderLinkTitleInput_fn","renderLinkTargetInput_fn","UmbLinkPickerModalElement","UmbModalBaseElement","__privateAdd","UmbValidationContext","_a","size","__privateSet","__privateMethod","html","_b","mediaTypeStructureRepository","UmbMediaTypeStructureRepository","mediaTypes","x","isUmbracoFolder","linkObject","event","query","url","name","parts","type","icon","unique","documentRepository","UmbDocumentDetailRepository","documentData","mediaRepository","UmbMediaDetailRepository","mediaData","link","__privateGet","umbConfirmModal","_c","e","nothing","umbBindToValidation","when","css","__decorateClass","state","customElement"],"mappings":"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"}